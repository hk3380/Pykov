<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pykov documentation</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h1 id="welcome-to-pykov-docs">Welcome to Pykov docs</h1>

<p>Pykov is a tiny Python module on <em>finite regular Markov chains</em>.</p>

<p>You can define a Markov chain from scratch or read it from a text file according specific format. Pykov is versatile, being it able to manipulate the chain, inserting and removing nodes, and to calculate various kind of quantities, like the steady state distribution, mean first passage times, random walks, absorbing times, and so on.</p>

<p>Pykov is licensed under the terms of the <strong>GNU General Public License</strong> as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>

<p>You are welcome to fork Pykov or open an issue on <a href="https://github.com/riccardoscalco/Pykov">github</a>.</p>

<hr>



<h2 id="installation">Installation</h2>

<p>Pykov can be installed  via <a href="http://pip.readthedocs.org/en/latest/#"><code>pip</code><i class="icon-forward"></i></a> </p>



<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>pip install pykov <span class="hljs-comment">#both Python2 and Python3</span>
</code></pre>

<p>Note that Pykov depends on <strong>numpy</strong> and <strong>scipy</strong>.</p>

<hr>



<h2 id="getting-started">Getting started</h2>

<p>Open your favourite Python shell and import pykov:</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> pykov
<span class="hljs-prompt">&gt;&gt;&gt; </span>pykov.__version__</code></pre>



<h3 id="vector-class">Vector class</h3>

<p>The <strong>Vector class</strong> inherits from python <code>dict</code>, which means it has the same behaviors and features of python dictionaries, with few exceptions. The states and the corresponding probabilities are the keys and the values of the dictionary, respectively.</p>

<p>Definition of a <code>pykov.Vector()</code>:</p>



<pre class="prettyprint"><code class=" hljs fix"><span class="hljs-attribute">&gt;&gt;&gt; p </span>=<span class="hljs-string"> pykov.Vector()</span></code></pre>

<p>You can <em>get</em> ans <em>set</em> states in many ways:</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p[<span class="hljs-string">'A'</span>] = <span class="hljs-number">.2</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>p
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.2</span>}

<span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector({<span class="hljs-string">'A'</span>:<span class="hljs-number">.3</span>, <span class="hljs-string">'B'</span>:<span class="hljs-number">.7</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>p
{<span class="hljs-string">'A'</span>:<span class="hljs-number">0.3</span>, <span class="hljs-string">'B'</span>:<span class="hljs-number">0.7</span>}

<span class="hljs-prompt">&gt;&gt;&gt; </span>pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.6</span>, C=<span class="hljs-number">.1</span>)
{<span class="hljs-string">'A'</span>:<span class="hljs-number">0.3</span>, <span class="hljs-string">'B'</span>:<span class="hljs-number">0.6</span>, <span class="hljs-string">'C'</span>:<span class="hljs-number">0.1</span>}</code></pre>

<p>States not belonging to the vector have zero probability, moreover states with zero probability are not shown:</p>



<pre class="prettyprint"><code class=" hljs perl">&gt;&gt;&gt; <span class="hljs-keyword">q</span> = pykov.Vector(C=.<span class="hljs-number">4</span>, B=.<span class="hljs-number">6</span>)
&gt;&gt;&gt; <span class="hljs-string">q['C']</span>
<span class="hljs-number">0</span>.<span class="hljs-number">4</span>
&gt;&gt;&gt; <span class="hljs-string">q['Z']</span>
<span class="hljs-number">0</span>.<span class="hljs-number">0</span>
&gt;&gt;&gt; <span class="hljs-string">'Z'</span> in <span class="hljs-keyword">q</span>
False

&gt;&gt;&gt; <span class="hljs-string">q['Z']</span>=.<span class="hljs-number">2</span>
&gt;&gt;&gt; <span class="hljs-string">q
{'C': 0.4, 'B': 0.6, 'Z': 0.2}</span>
&gt;&gt;&gt; <span class="hljs-string">'Z'</span> in <span class="hljs-keyword">q</span>
True
&gt;&gt;&gt; <span class="hljs-string">q['Z']</span>=<span class="hljs-number">0</span>
&gt;&gt;&gt; <span class="hljs-string">q
{'C': 0.4, 'B': 0.6}</span>
&gt;&gt;&gt; <span class="hljs-string">'Z'</span> in <span class="hljs-keyword">q</span>
False</code></pre>



<h4 id="vector-operations">Vector operations</h4>



<h5 id="sum"><strong>Sum</strong></h5>

<p>A <code>pykov.Vector()</code> instance can be added or substracted to another <code>pykov.Vector()</code> instance:</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>q = pykov.Vector(C=<span class="hljs-number">.5</span>, B=<span class="hljs-number">.5</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p + q
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.3</span>, <span class="hljs-string">'C'</span>: <span class="hljs-number">0.5</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">1.2</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>p - q
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.3</span>, <span class="hljs-string">'C'</span>: -<span class="hljs-number">0.5</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.2</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>q - p
{<span class="hljs-string">'A'</span>: -<span class="hljs-number">0.3</span>, <span class="hljs-string">'C'</span>: <span class="hljs-number">0.5</span>, <span class="hljs-string">'B'</span>: -<span class="hljs-number">0.2</span>}</code></pre>



<h5 id="product"><strong>Product</strong></h5>

<p>A <code>pykov.Vector()</code> instance can be multiplied by a scalar. The <em>dot product</em> with another <code>pykov.Vector()</code> or <code>pykov.Matrix()</code> instance is also supported.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p * <span class="hljs-number">3</span>
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.9</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">2.1</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span><span class="hljs-number">3</span> * p
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.9</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">2.1</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>q = pykov.Vector(C=<span class="hljs-number">.5</span>, B=<span class="hljs-number">.5</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p * q
<span class="hljs-number">0.35</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>p * T
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.91</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.09</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T * p
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.42</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.3</span>}</code></pre>



<h4 id="vector-methods">Vector methods</h4>



<h5 id="sum-1"><strong>sum()</strong></h5>

<p>Sum the probability values.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.sum()
<span class="hljs-number">1.0</span></code></pre>



<h5 id="sortreversefalse"><strong>sort(reverse=False)</strong></h5>

<p>Return a list of tuples <code>(state, probability)</code> sorted according the probability values.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector({<span class="hljs-string">'A'</span>:<span class="hljs-number">.3</span>, <span class="hljs-string">'B'</span>:<span class="hljs-number">.1</span>, <span class="hljs-string">'C'</span>:<span class="hljs-number">.6</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.sort()
[(<span class="hljs-string">'B'</span>, <span class="hljs-number">0.1</span>), (<span class="hljs-string">'A'</span>, <span class="hljs-number">0.3</span>), (<span class="hljs-string">'C'</span>, <span class="hljs-number">0.6</span>)]
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.sort(reverse=<span class="hljs-keyword">True</span>)
[(<span class="hljs-string">'C'</span>, <span class="hljs-number">0.6</span>), (<span class="hljs-string">'A'</span>, <span class="hljs-number">0.3</span>), (<span class="hljs-string">'B'</span>, <span class="hljs-number">0.1</span>)]</code></pre>



<h5 id="choose"><strong>choose()</strong></h5>

<p>Choose a state at random, according to its probability.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.choose()
<span class="hljs-string">'B'</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.choose()
<span class="hljs-string">'B'</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.choose()
<span class="hljs-string">'A'</span></code></pre>



<h5 id="normalize"><strong>normalize()</strong></h5>

<p>Normalize the <code>pykov.Vector</code>, after normalization the probabilities sum to 1.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector({<span class="hljs-string">'A'</span>:<span class="hljs-number">3</span>, <span class="hljs-string">'B'</span>:<span class="hljs-number">1</span>, <span class="hljs-string">'C'</span>:<span class="hljs-number">6</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.sum()
<span class="hljs-number">10.0</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.normalize()
<span class="hljs-prompt">&gt;&gt;&gt; </span>p
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.3</span>, <span class="hljs-string">'C'</span>: <span class="hljs-number">0.6</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.1</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.sum()
<span class="hljs-number">1.0</span></code></pre>



<h5 id="copy"><strong>copy()</strong></h5>

<p>Return a shallow copy.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>q = p.copy()
<span class="hljs-prompt">&gt;&gt;&gt; </span>p[<span class="hljs-string">'C'</span>] = <span class="hljs-number">1.</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>q
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.3</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.7</span>}</code></pre>



<h5 id="entropy"><strong>entropy()</strong></h5>

<p>Return the Shannon entropy, defined as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1" style="width: 8.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.91em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-8" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; top: -1.999em; left: 1.054em;"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.498em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.05em; left: 0.503em;"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Main; padding-left: 0.153em;">ln</span><span class="mo" id="MathJax-Span-15"></span><span class="msubsup" id="MathJax-Span-16" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.498em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.05em; left: 0.503em;"><span class="mi" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">H(p) = \sum_i p_i \ln p_i</script>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.entropy()
<span class="hljs-number">0.6108643020548935</span></code></pre>

<p>For further details, have a look at <em>Khinchin A. I., Mathematical Foundations of Information Theory Dover, 1957</em>.</p>



<h5 id="distq"><strong>dist(q)</strong></h5>

<p>Return the distance to another <code>pykov.Vector</code>, defined as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-19" style="width: 10.063em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.062em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic; padding-left: 0.153em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-28" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; top: -1.999em; left: 1.054em;"><span class="mi" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="texatom" id="MathJax-Span-31" style="padding-left: 0.153em;"><span class="mrow" id="MathJax-Span-32"><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.498em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.05em; left: 0.503em;"><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-38" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.05em; left: 0.503em;"><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">d(p,q) = \sum_i | p_i - q_i |</script>. </p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>q = pykov.Vector(C=<span class="hljs-number">.5</span>, B=<span class="hljs-number">.5</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.dist(q)
<span class="hljs-number">1.0</span></code></pre>



<h5 id="relativeentropyq"><strong>relative_entropy(q)</strong></h5>

<p>Return the <em>Kullback-Leibler</em> distance, defined as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-44" style="width: 11.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.363em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic; padding-left: 0.153em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-53" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; top: -1.999em; left: 1.054em;"><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-56" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.498em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.05em; left: 0.503em;"><span class="mi" id="MathJax-Span-58" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Main; padding-left: 0.153em;">ln</span><span class="mo" id="MathJax-Span-60"></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.498em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.05em; left: 0.503em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="texatom" id="MathJax-Span-65"><span class="mrow" id="MathJax-Span-66"><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.05em; left: 0.503em;"><span class="mi" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">d(p,q) = \sum_i p_i \ln (p_i/q_i)</script>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>q = pykov.Vector(A=<span class="hljs-number">.4</span>, B=<span class="hljs-number">.6</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p.relative_entropy(q) <span class="hljs-comment">#d(p,q)</span>
<span class="hljs-number">0.02160085414354654</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>q.relative_entropy(p) <span class="hljs-comment">#d(q,p)</span>
<span class="hljs-number">0.022582421084357485</span></code></pre>

<p>Note that the Kullback-Leibler distance is not symmetric.</p>

<hr>



<h3 id="matrix-class">Matrix class</h3>

<p>The <code>pykov.Matrix()</code> class inherits from python dictionaries. Dict <code>keys</code> are <code>tuple</code> of states, dict <code>values</code> are the matrix entries. Indexes do not need to be <code>int</code>, they can be <code>string</code>, as the states of a <code>pykov.Vector()</code>.</p>

<p>Definition of  <code>pykov.Matrix()</code>:</p>



<pre class="prettyprint"><code class=" hljs fix"><span class="hljs-attribute">&gt;&gt;&gt; T </span>=<span class="hljs-string"> pykov.Matrix()</span></code></pre>

<p>You can <em>get</em> ans <em>set</em> items in many ways:</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix()
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>)] = <span class="hljs-number">.3</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T
{(<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>] = <span class="hljs-number">.7</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T
{(<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>}

<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>)]
<span class="hljs-number">0.3</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>]
<span class="hljs-number">0.3</span></code></pre>

<p>Items not belonging to the matrix have value equal to zero, moreover items with value equal to zero are not shown:</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[<span class="hljs-string">'B'</span>,<span class="hljs-string">'B'</span>]
<span class="hljs-number">0.0</span>

<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T
{(<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>, (<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>] = <span class="hljs-number">0</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T
{(<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>}</code></pre>



<h4 id="matrix-operations">Matrix operations</h4>



<h5 id="sum-2"><strong>Sum</strong></h5>

<p>A <code>pykov.Matrix()</code> instance can be added or substracted to another <code>pykov.Matrix()</code> instance.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>I = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>):<span class="hljs-number">1</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'B'</span>):<span class="hljs-number">1</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T + I
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.7</span>, (<span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">1.0</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T - I
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): -<span class="hljs-number">0.3</span>, (<span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>): -<span class="hljs-number">1</span>}</code></pre>



<h5 id="product-1"><strong>Product</strong></h5>

<p>A <code>pykov.Matrix()</code> instance can be multiplied by a scalar, the dot product with a <code>pykov.Vector()</code> or another <code>pykov.Matrix()</code> instance is also supported.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T * <span class="hljs-number">3</span>
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">3.0</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.9</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">2.1</span>}

<span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">.3</span>, B=<span class="hljs-number">.7</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>T * p
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.42</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.3</span>}

<span class="hljs-prompt">&gt;&gt;&gt; </span>W = pykov.Matrix({(<span class="hljs-string">'N'</span>, <span class="hljs-string">'M'</span>): <span class="hljs-number">0.5</span>, (<span class="hljs-string">'M'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.7</span>,
                      (<span class="hljs-string">'M'</span>, <span class="hljs-string">'M'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'O'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.5</span>,
                      (<span class="hljs-string">'O'</span>, <span class="hljs-string">'O'</span>): <span class="hljs-number">0.5</span>, (<span class="hljs-string">'N'</span>, <span class="hljs-string">'O'</span>): <span class="hljs-number">0.5</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>W * W
{(<span class="hljs-string">'N'</span>, <span class="hljs-string">'M'</span>): <span class="hljs-number">0.15</span>, (<span class="hljs-string">'M'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.21</span>, (<span class="hljs-string">'M'</span>, <span class="hljs-string">'O'</span>): <span class="hljs-number">0.35</span>,
 (<span class="hljs-string">'M'</span>, <span class="hljs-string">'M'</span>): <span class="hljs-number">0.44</span>, (<span class="hljs-string">'O'</span>, <span class="hljs-string">'M'</span>): <span class="hljs-number">0.25</span>, (<span class="hljs-string">'O'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.25</span>,
 (<span class="hljs-string">'O'</span>, <span class="hljs-string">'O'</span>): <span class="hljs-number">0.5</span>, (<span class="hljs-string">'N'</span>, <span class="hljs-string">'O'</span>): <span class="hljs-number">0.25</span>, (<span class="hljs-string">'N'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.6</span>}</code></pre>



<h4 id="matrix-methods">Matrix methods</h4>



<h5 id="states"><strong>states()</strong></h5>

<p>Return the <code>set</code> of states.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.states()
{<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>}</code></pre>

<p>States without ingoing or outgoing transitions are removed from the set of states.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T[<span class="hljs-string">'A'</span>,<span class="hljs-string">'C'</span>]=<span class="hljs-number">1</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.states()
{<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'B'</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[<span class="hljs-string">'A'</span>,<span class="hljs-string">'C'</span>]=<span class="hljs-number">0</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.states()
{<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>}</code></pre>



<h5 id="predkeynone"><strong>pred(key=None)</strong></h5>

<p>Return the precedessors of a state (if not indicated, of all states). In matrix notation, return the column of the indicated state.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.pred()
{<span class="hljs-string">'A'</span>: {<span class="hljs-string">'A'</span>: <span class="hljs-number">0.7</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">1.0</span>}, <span class="hljs-string">'B'</span>: {<span class="hljs-string">'A'</span>: <span class="hljs-number">0.3</span>}}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.pred(<span class="hljs-string">'A'</span>)
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.7</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">1.0</span>}</code></pre>



<h5 id="succkeynone"><strong>succ(key=None)</strong></h5>

<p>Return the successors of a state (if not indicated, of all states). In matrix notation, return the row of the indicated state.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.succ()
{<span class="hljs-string">'A'</span>: {<span class="hljs-string">'A'</span>: <span class="hljs-number">0.7</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.3</span>}, <span class="hljs-string">'B'</span>: {<span class="hljs-string">'A'</span>: <span class="hljs-number">1.0</span>}}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.succ(<span class="hljs-string">'A'</span>)
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.7</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.3</span>}</code></pre>



<h5 id="copy-1"><strong>copy()</strong></h5>

<p>Return a shallow copy.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>W = T.copy()
<span class="hljs-prompt">&gt;&gt;&gt; </span>T[(<span class="hljs-string">'B'</span>,<span class="hljs-string">'B'</span>)] = <span class="hljs-number">1.</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>W
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>}</code></pre>



<h5 id="removestates"><strong>remove(states)</strong></h5>

<p>Return a shallow copy of the matrix without the indicated states. <br>
All the links where the states appear are deleted, so that the result will not be in general a stochastic matrix.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.remove([<span class="hljs-string">'B'</span>])
{(<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>,
                     (<span class="hljs-string">'C'</span>,<span class="hljs-string">'D'</span>): <span class="hljs-number">.5</span>, (<span class="hljs-string">'D'</span>,<span class="hljs-string">'C'</span>): <span class="hljs-number">1.</span>, (<span class="hljs-string">'C'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.5</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.remove([<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>])
{(<span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>): <span class="hljs-number">0.5</span>, (<span class="hljs-string">'D'</span>, <span class="hljs-string">'C'</span>): <span class="hljs-number">1.0</span>}</code></pre>



<h5 id="stochastic"><strong>stochastic()</strong></h5>

<p>Change the <code>pykov.Matrix()</code> instance in a right <a href="http://en.wikipedia.org/wiki/Stochastic_matrix">stochastic matrix</a>. <br>
Set the sum of every row equal to one, raise <code>PykovError</code> if not possible.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.2</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.stochastic()
<span class="hljs-prompt">&gt;&gt;&gt; </span>T
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>}

<span class="hljs-prompt">&gt;&gt;&gt; </span>T[(<span class="hljs-string">'A'</span>,<span class="hljs-string">'C'</span>)]=<span class="hljs-number">1</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.stochastic()
pykov.PykovError: <span class="hljs-string">'Zero links from node C'</span></code></pre>



<h5 id="transpose"><strong>transpose()</strong></h5>

<p>Return the transpose of the <code>pykov.Matrix()</code> instance.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.transpose()
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">1.0</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T
{(<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>, (<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>}</code></pre>



<h5 id="eye"><strong>eye()</strong></h5>

<p>Return the <a href="http://en.wikipedia.org/wiki/Identity_matrix">Identity matrix</a>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.eye()
{(<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>, (<span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">1.</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>type(T.eye())
&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> '<span class="hljs-title">pykov</span>.<span class="hljs-title">Matrix</span>'&gt;</span></code></pre>



<h5 id="ones"><strong>ones()</strong></h5>

<p>Return a <code>pykov.Vector()</code> instance with entries equal to 1.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.ones()
{<span class="hljs-string">'A'</span>: <span class="hljs-number">1.0</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">1.0</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>type(T.ones())
&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> '<span class="hljs-title">pykov</span>.<span class="hljs-title">Vector</span>'&gt;</span></code></pre>



<h5 id="trace"><strong>trace()</strong></h5>

<p>Return the matrix <a href="http://en.wikipedia.org/wiki/Trace_%28linear_algebra%29">trace</a>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Matrix({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.trace()
<span class="hljs-number">0.7</span></code></pre>

<hr>



<h3 id="chain-class">Chain class</h3>

<p>The <code>pykov.Chain</code> class inherits from <code>pykov.Matrix</code> class. The dict <code>key</code> is a tuple of states, the dict <code>value</code> is the transition probability to go from the first state to the second state.</p>



<h4 id="chain-methods">Chain methods</h4>



<h5 id="adjacency"><strong>adjacency()</strong></h5>

<p>Return the <a href="http://en.wikipedia.org/wiki/Adjacency_matrix">adjacency matrix</a>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.adjacency()
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">1</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>type(T.adjacency())
&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> '<span class="hljs-title">pykov</span>.<span class="hljs-title">Matrix</span>'&gt;</span></code></pre>



<h5 id="powp-n"><strong>pow(p, n)</strong></h5>

<p>Find the probability distribution after <code>n</code> steps, starting from an initial <code>pykov.Vector()</code> <code>p</code>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector(A=<span class="hljs-number">1</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.pow(p,<span class="hljs-number">3</span>)
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.7629999999999999</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.23699999999999996</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>p * T * T * T <span class="hljs-comment">#not efficient</span>
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.7629999999999999</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.23699999999999996</span>}</code></pre>



<h5 id="movestate"><strong>move(state)</strong></h5>

<p>Do one step from the indicated <code>state</code> to one of its successors, chosen at random according to the transition probability. Return the new state.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.move(<span class="hljs-string">'A'</span>)
<span class="hljs-string">'B'</span></code></pre>



<h5 id="walksteps-startnone-stopnone"><strong>walk(steps, start=None, stop=None)</strong></h5>

<p>Return a random walk of n <code>steps</code>, starting and stopping at the indicated states.  If not indicated, then the starting state is chosen according to the steady state probability. If the stopping state is reached before to do n steps, then the walker stops.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.walk(<span class="hljs-number">10</span>)
[<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>]
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.walk(<span class="hljs-number">10</span>,<span class="hljs-string">'B'</span>,<span class="hljs-string">'B'</span>)
[<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]</code></pre>



<h5 id="walkprobabilitywalk"><strong>walk_probability(walk)</strong></h5>

<p>Return the <em>logarithm</em> of the <strong>walk</strong> probability (see <code>walk()</code> method). Impossible walks have probability equal to zero.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.walk_probability([<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>])
-<span class="hljs-number">1.917322692203401</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>probability = math.exp(-<span class="hljs-number">1.917322692203401</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>probability
<span class="hljs-number">0.147</span>

<span class="hljs-prompt">&gt;&gt;&gt; </span>p = T.walk_probability([<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>,<span class="hljs-string">'B'</span>,<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>])
<span class="hljs-prompt">&gt;&gt;&gt; </span>math.exp(p)
<span class="hljs-number">0.0</span></code></pre>



<h5 id="steady"><strong>steady()</strong></h5>

<p>Return the steady state, i.e. the equilibrium distribution of the chain. </p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.steady()
{<span class="hljs-string">'A'</span>: <span class="hljs-number">0.7692307692307676</span>, <span class="hljs-string">'B'</span>: <span class="hljs-number">0.23076923076923028</span>}</code></pre>

<p>The steady state <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-72" style="width: 0.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.553em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">x</script> is calculated with the <em>inverse iteration method</em> <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-75" style="width: 3.956em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.556em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 3.056em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-76"><span class="msubsup" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.855em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.75em; left: 0.803em;"><span class="mi" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">e</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">Q^t x = e</script>, where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-83" style="width: 5.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.657em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.854em 1000.003em 3.056em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic; padding-left: 0.203em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.114em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">Q = I - T</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-90" style="width: 7.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.859em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="mn" id="MathJax-Span-95" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-97" style="font-family: MathJax_Main; padding-left: 0.153em;">0</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.153em;">.</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.153em;">.</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.153em;">.</span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.153em;">,</span><span class="mn" id="MathJax-Span-103" style="font-family: MathJax_Main; padding-left: 0.153em;">1</span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.225em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">e = (0,0,...,1)</script>.</p>

<p>For further details, have a look at <em>W. Stewart, Introduction to the Numerical Solution of Markov Chains, Princeton University Press, Chichester, West Sussex, 1994</em>.</p>



<h5 id="mixingtimecutoff025-jump1-pnone"><strong>mixing_time(cutoff=0.25, jump=1, p=None)</strong></h5>

<p>Return the <a href="http://en.wikipedia.org/wiki/Markov_chain_mixing_time">mixing time</a>, defined as the number of steps needed to have <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-105" style="width: 8.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.41em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-106"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">p</span><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 1.304em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.448em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.7em; left: 0.853em;"><span class="mi" id="MathJax-Span-113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic; padding-left: 0.203em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.303em;">&lt;</span><span class="mn" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.303em;">0.25</span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.225em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">|pT^n - \pi|<0.25</script>, where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-121" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.448em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\pi</script> is the steady state <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-124" style="width: 3.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.256em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.854em 1000.003em 2.855em -0.448em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\pi = \pi T</script>.</p>

<p>If the initial distribution <code>p</code> is not indicated, then the iteration starts from the less probable state of the steady distribution. The parameter <code>jump</code> controls the iteration step, for example with <code>jump=2</code> n has values 2,4,6,8,..</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>d = {(<span class="hljs-string">'R'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>, (<span class="hljs-string">'R'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'R'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>,
         (<span class="hljs-string">'N'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>, (<span class="hljs-string">'N'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">0.</span>, (<span class="hljs-string">'N'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>,
         (<span class="hljs-string">'S'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'S'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'S'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain(d)
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.mixing_time()
<span class="hljs-number">2</span></code></pre>



<h5 id="entropypnone-normfalse"><strong>entropy(p=None, norm=False)</strong></h5>

<p>Return the Chain entropy, defined as <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-130" style="width: 6.609em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.958em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.156em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-134" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; top: -1.999em; left: 1.054em;"><span class="mi" id="MathJax-Span-136" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-137" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.448em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.15em; left: 0.603em;"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-140"><span style="display: inline-block; position: relative; width: 1.204em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.15em; left: 0.903em;"><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">H = \sum_i \pi_i H_i</script>, where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-143" style="width: 8.761em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.86em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.306em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-144"><span class="msubsup" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 1.204em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.15em; left: 0.903em;"><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="munderover" id="MathJax-Span-149" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; top: -1.999em; left: 1.054em;"><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-152" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.448em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.15em; left: 0.653em;"><span class="texatom" id="MathJax-Span-154"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.153em;">ln</span><span class="mo" id="MathJax-Span-159"></span><span class="msubsup" id="MathJax-Span-160" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.448em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.15em; left: 0.653em;"><span class="texatom" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.305em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.447em; vertical-align: -0.553em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">H_i=\sum_j T_{ij}\ln T_{ij}</script>. <br>
If <code>p</code> is not <code>None</code>, then the entropy is calculated with the indicated probability <code>pykov.Vector()</code>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.entropy()
<span class="hljs-number">0.46989561696530169</span></code></pre>

<p>With <strong>norm=True</strong> entropy belongs to [0,1].</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T.entropy(norm=<span class="hljs-keyword">True</span>)
<span class="hljs-number">0.33895603665233132</span></code></pre>

<p>For further details, have a look at <em>Khinchin A. I., Mathematical Foundations of Information Theory, Dover, 1957</em>.</p>



<h5 id="mfpttostate"><strong>mfpt_to(state)</strong></h5>

<p>Return the Mean First Passage Times of every state <em>to</em> the indicated <code>state</code>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>d = {(<span class="hljs-string">'R'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.25</span>, (<span class="hljs-string">'R'</span>, <span class="hljs-string">'S'</span>): <span class="hljs-number">0.25</span>, (<span class="hljs-string">'S'</span>, <span class="hljs-string">'R'</span>): <span class="hljs-number">0.25</span>,
         (<span class="hljs-string">'R'</span>, <span class="hljs-string">'R'</span>): <span class="hljs-number">0.5</span>, (<span class="hljs-string">'N'</span>, <span class="hljs-string">'S'</span>): <span class="hljs-number">0.5</span>, (<span class="hljs-string">'S'</span>, <span class="hljs-string">'S'</span>): <span class="hljs-number">0.5</span>,
         (<span class="hljs-string">'S'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.25</span>, (<span class="hljs-string">'N'</span>, <span class="hljs-string">'R'</span>): <span class="hljs-number">0.5</span>, (<span class="hljs-string">'N'</span>, <span class="hljs-string">'N'</span>): <span class="hljs-number">0.0</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain(d)
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.mfpt_to(<span class="hljs-string">'R'</span>)
{<span class="hljs-string">'S'</span>: <span class="hljs-number">3.333333333333333</span>, <span class="hljs-string">'N'</span>: <span class="hljs-number">2.666666666666667</span>} <span class="hljs-comment">#mfpt from 'S' to 'R' is 3.33</span></code></pre>

<p>See also <em>Kemeny J. G. and Snell, J. L., Finite Markov Chains. Springer-Verlag: New York, 1976</em>.</p>



<h5 id="absorbingtimetransientset"><strong>absorbing_time(transient_set)</strong></h5>

<p>Mean number of steps needed to leave the <code>transient_set</code>, return the <code>pykov.Vector()</code> <code>tau</code> where <code>tau[i]</code> is the mean number of steps needed to leave the transient set starting from state <code>i</code>. The parameter <code>transient_set</code> is a subset of states (iterable).</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>d = {(<span class="hljs-string">'R'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>, (<span class="hljs-string">'R'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'R'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>,
         (<span class="hljs-string">'N'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>, (<span class="hljs-string">'N'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">0.</span>, (<span class="hljs-string">'N'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>,
         (<span class="hljs-string">'S'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'S'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'S'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain(d)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector({<span class="hljs-string">'N'</span>:<span class="hljs-number">.3</span>, <span class="hljs-string">'S'</span>:<span class="hljs-number">.7</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>tau = T.absorbing_time(p.keys())
<span class="hljs-prompt">&gt;&gt;&gt; </span>tau
{<span class="hljs-string">'S'</span>: <span class="hljs-number">3.333333333333333</span>, <span class="hljs-string">'N'</span>: <span class="hljs-number">2.6666666666666665</span>}</code></pre>

<p>In other words, the mean number of steps in order to leave states <code>'S'</code> and <code>'N'</code> starting from <code>'S'</code> is 3.33. <br>
It is sufficient to calculate <code>p * tau</code> in order to weight the mean times according an initial distribution <code>p</code>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>p * tau
<span class="hljs-number">3.1333333333333329</span></code></pre>

<p>In order to better understand the meaning of the method, the calculation of the previous example can be approximated by means of many random walkers:</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>numpy.mean([len(T.walk(<span class="hljs-number">10000000</span>,<span class="hljs-string">"S"</span>,<span class="hljs-string">"R"</span>))-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1000000</span>)])
<span class="hljs-number">3.3326020000000001</span>
<span class="hljs-prompt">&gt;&gt;&gt; </span>numpy.mean([len(T.walk(<span class="hljs-number">10000000</span>,<span class="hljs-string">"N"</span>,<span class="hljs-string">"R"</span>))-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1000000</span>)])
<span class="hljs-number">2.6665549999999998</span></code></pre>



<h5 id="absorbingtourp-transientsetnone"><strong>absorbing_tour(p, transient_set=None)</strong></h5>

<p>Return a <code>pykov.Vector()</code> <code>v</code>, where <code>v[i]</code> is the mean time the process is in the transient state <code>i</code> before leaving the transient set.</p>

<p>Note that <code>v.sum()</code> is equal to <code>p * tau</code> (see <code>absorbing_time()</code> method). <br>
If not specified, the transient set is defined as the set of states in vector <code>p</code>.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>d = {(<span class="hljs-string">'R'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>, (<span class="hljs-string">'R'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'R'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>,
         (<span class="hljs-string">'N'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>, (<span class="hljs-string">'N'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">0.</span>, (<span class="hljs-string">'N'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>,
         (<span class="hljs-string">'S'</span>,<span class="hljs-string">'R'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'S'</span>,<span class="hljs-string">'N'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">4</span>, (<span class="hljs-string">'S'</span>,<span class="hljs-string">'S'</span>):<span class="hljs-number">1.</span>/<span class="hljs-number">2</span>}
<span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain(d)
<span class="hljs-prompt">&gt;&gt;&gt; </span>p = pykov.Vector({<span class="hljs-string">'N'</span>:<span class="hljs-number">.3</span>, <span class="hljs-string">'S'</span>:<span class="hljs-number">.7</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.absorbing_tour(p)
{<span class="hljs-string">'S'</span>: <span class="hljs-number">2.2666666666666666</span>, <span class="hljs-string">'N'</span>: <span class="hljs-number">0.8666666666666669</span>}</code></pre>



<h5 id="fundamentalmatrix"><strong>fundamental_matrix()</strong></h5>

<p>Return the fundamental matrix, have a look at <em>Kemeny J. G. and Snell J. L., Finite Markov Chains. Springer-Verlag: New York, 1976</em> for further details.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.fundamental_matrix()
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.17751479289940991</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.053254437869822958</span>,
(<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.94674556213017902</span>, (<span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.82248520710059214</span>}</code></pre>

<p>Note that the fundamental matrix is not sparse.</p>



<h5 id="kemenyconstant"><strong>kemeny_constant()</strong></h5>

<p>Return the Kemeny constant of the transition matrix.</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>T = pykov.Chain({(<span class="hljs-string">'A'</span>,<span class="hljs-string">'B'</span>): <span class="hljs-number">.3</span>, (<span class="hljs-string">'A'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">.7</span>, (<span class="hljs-string">'B'</span>,<span class="hljs-string">'A'</span>): <span class="hljs-number">1.</span>})
<span class="hljs-prompt">&gt;&gt;&gt; </span>T.kemeny_constant()
<span class="hljs-number">1.7692307692307712</span></code></pre>

<hr>



<h2 id="utilities">Utilities</h2>

<p>Pykov comes with an utility useful to create a <code>pykov.Chain()</code> from a text file, let say file <code>/mypath/mat</code>, which contains the transition matrix defined with the following format:</p>



<pre class="prettyprint"><code class=" hljs autohotkey"><span class="hljs-literal">A</span> <span class="hljs-literal">A</span> .<span class="hljs-number">7</span>
<span class="hljs-literal">A</span> B .<span class="hljs-number">3</span>
B <span class="hljs-literal">A</span> <span class="hljs-number">1</span></code></pre>

<p>The <code>pykov.Chain()</code> instance is created with the command:</p>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-prompt">&gt;&gt;&gt; </span>P = pykov.readmat(<span class="hljs-string">'/mypath/mat'</span>)
<span class="hljs-prompt">&gt;&gt;&gt; </span>P
{(<span class="hljs-string">'B'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">1.0</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>): <span class="hljs-number">0.3</span>, (<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>): <span class="hljs-number">0.7</span>}</code></pre>

<hr>

<blockquote>
  <p>Docs written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote></div></body>
</html>